<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EIWYG - Editor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gridstack@10/dist/gridstack.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gridstack@10/dist/gridstack-extra.min.css">
    <link rel="stylesheet" href="/static/css/editor.css">
    <link rel="stylesheet" href="/static/css/components.css">
</head>
<body>

<!-- ── Top Bar ─────────────────────────────────────────────────────── -->
<div class="top-bar">
    <a href="/" class="top-bar-logo">EIWYG</a>
    <div class="top-bar-fields">
        <div class="field-with-tooltip">
            <input type="text" id="dashboard-username" class="top-bar-field field-username" placeholder="Username">
            <span class="field-tooltip" data-tooltip="Who this dashboard will belong to. Can be your name, or your beamline.">?</span>
        </div>
        <input type="text" id="dashboard-title" class="top-bar-field field-title" placeholder="Dashboard Title">
        <input type="text" id="dashboard-description" class="top-bar-field field-description" placeholder="Description">
        <div class="field-with-tooltip">
            <input type="text" id="dashboard-slug" class="top-bar-field field-slug" placeholder="my-dashboard">
            <span class="field-tooltip" data-tooltip="The slug. The URL endpoint and short name this dashboard will be referenced by.">?</span>
            <span id="slug-error" class="slug-error"></span>
        </div>
        <div class="field-with-tooltip" id="pw-field-wrapper">
            <input type="text" id="dashboard-pw" class="top-bar-field field-pw" placeholder="pw">
            <span class="field-tooltip" data-tooltip="A simple key to prevent accidental modifications. Also required for Write mode. Not a password — all dashboards are openly viewable. Keep it simple, like 'bl15-2' (but not that, that one's mine).">?</span>
        </div>
    </div>
    <div class="top-bar-actions">
        <button id="btn-save" class="btn btn-primary">Save</button>
        <button id="btn-freeze" class="btn btn-success">Save &amp; View</button>
    </div>
</div>

<!-- ── Editor Layout ──────────────────────────────────────────────── -->
<div class="editor-layout">

    <div class="editor-main">

        <!-- Component Palette -->
        <div class="palette" id="palette">
            <div class="palette-header">Components</div>
            <div class="palette-items" id="palette-items">
                <!-- Palette items are rendered by JS -->
            </div>

            <!-- Theme Selector -->
            <div class="theme-section">
                <div class="palette-header">Theme</div>
                <div class="theme-selector-wrapper">
                    <select id="theme-selector" class="theme-select">
                        <option value="blue-dream">Blue Dream</option>
                        <option value="earthy">Earthy</option>
                        <option value="light">Light</option>
                        <option value="pastel">Pastel</option>
                        <option value="mondrian">Mondrian</option>
                        <option value="ssrl">SSRL</option>
                        <option value="vintage">Vintage</option>
                    </select>
                </div>
            </div>

        </div>

        <!-- Grid Area -->
        <div class="grid-container" id="grid-container">
            <div class="grid-stack" id="grid"></div>
        </div>

        <!-- Config Panel -->
        <div class="config-panel" id="config-panel">
            <div class="config-panel-empty" id="config-empty">
                Select a widget to configure
            </div>
            <div id="config-content" style="display:none;">
                <div class="config-header">
                    Widget Configuration
                </div>
                <div class="config-body" id="config-body">
                    <!-- Config fields rendered by JS -->
                </div>
            </div>
        </div>

    </div>

    <!-- Variables Panel -->
    <div class="variables-panel" id="variables-panel">
        <div class="variables-header" id="variables-header">
            <span>Variables</span>
            <span class="field-tooltip" data-tooltip="Define template variables for your dashboard. Any widget PV can use {VarName} syntax, e.g. IOC:{Beamline}:Temperature. Change the variable value in one place and all widgets update. Useful when cloning dashboards for different beamlines.">?</span>
            <span class="variables-toggle" id="variables-toggle">&#9660;</span>
        </div>
        <div class="variables-body collapsed" id="variables-body">
            <div class="variables-list" id="variables-list">
                <!-- Variable rows rendered by JS -->
            </div>
            <button class="btn btn-sm" id="btn-add-variable">+ Add Variable</button>
        </div>
    </div>

    <!-- AI Chatbot Panel (commented out for now — do NOT delete, re-enable when LLM is ready) -->
    <!--
    <div class="chatbot-panel" id="chatbot-panel" style="height: 200px;">
        <div class="chatbot-header" id="chatbot-header">
            <span class="chatbot-header-title">AI Assistant</span>
            <span class="chatbot-toggle" id="chatbot-toggle">&#9660;</span>
        </div>
        <div class="chatbot-messages" id="chatbot-messages"></div>
        <div class="chatbot-input-area">
            <input type="text" id="chatbot-input" class="chatbot-input"
                   placeholder="Describe the GUI you want to build...">
            <button id="chatbot-send" class="btn btn-primary btn-sm">Send</button>
        </div>
    </div>
    -->
</div>

<script src="https://cdn.jsdelivr.net/npm/gridstack@10/dist/gridstack-all.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
<script src="/static/js/components.js"></script>
<script src="/static/js/editor.js"></script>
</body>
</html>
